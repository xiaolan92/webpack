(window.webpackJsonp=window.webpackJsonp||[]).push([[13],{"H/vC":function(e,t,s){(t=s("JPst")(!1)).push([e.i,".roleContent[data-v-14505c45]{display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-orient:vertical;-webkit-box-direction:normal;-ms-flex-direction:column;flex-direction:column}.roleContent .addRole[data-v-14505c45]{-ms-flex-item-align:end;align-self:flex-end;border:1px solid #f7961c;padding:7px 20px;border-radius:4px;margin:15px 0;cursor:pointer}.roleContent .sort-content[data-v-14505c45]{height:900px;margin-top:10px}.roleContent .sort-content .pagination[data-v-14505c45]{margin-top:15px}\n",""]),e.exports=t},HDAX:function(e,t,s){var a=s("H/vC");"string"==typeof a&&(a=[[e.i,a,""]]),a.locals&&(e.exports=a.locals);(0,s("SZ7m").default)("16d3fe58",a,!1,{})},HuZL:function(e,t,s){"use strict";var a=s("HDAX");s.n(a).a},"xP+0":function(e,t,s){"use strict";s.r(t);function a(){var s=this,e=s.$createElement,a=s._self._c||e;return a("div",{staticClass:"roleContent"},[a("el-dialog",{attrs:{title:"添加角色",visible:s.dialogVisible,width:"600px","before-close":s.close}},[a("el-form",[a("el-form-item",{attrs:{label:"角色名称"}},[a("el-input",{staticStyle:{width:"300px"},model:{value:s.form.name,callback:function(e){s.$set(s.form,"name",e)},expression:"form.name"}})],1),s._v(" "),a("el-form-item",{attrs:{label:"角色权限"}},[a("div",{staticStyle:{"margin-top":"10px"}},[a("el-tree",{ref:"tree",staticStyle:{"margin-left":"80px"},attrs:{data:s.permisssionMenu,"show-checkbox":"","node-key":"id",props:s.defaultProps}})],1)])],1),s._v(" "),a("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:s.close}},[s._v("取 消")]),s._v(" "),a("el-button",{attrs:{type:"primary"},on:{click:s.confirm}},[s._v("确 定")])],1)],1),s._v(" "),a("el-dialog",{attrs:{title:"修改角色",visible:s.modifyStatus,width:"600px","before-close":s.close}},[a("el-form",[a("el-form-item",{attrs:{label:"角色名称"}},[a("el-input",{staticStyle:{width:"300px"},model:{value:s.form.roleName,callback:function(e){s.$set(s.form,"roleName",e)},expression:"form.roleName"}})],1),s._v(" "),a("el-form-item",{attrs:{label:"角色权限"}},[a("div",{staticStyle:{"margin-top":"10px"}},[a("el-tree",{ref:"tree",staticStyle:{"margin-left":"80px"},attrs:{data:s.permisssionMenu,"show-checkbox":"","node-key":"id",props:s.defaultProps},on:{"check-change":s.onChange}})],1)])],1),s._v(" "),a("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:s.close}},[s._v("取 消")]),s._v(" "),a("el-button",{attrs:{type:"primary"},on:{click:s.confirmModify}},[s._v("确 定")])],1)],1),s._v(" "),a("div",{staticClass:"addRole",on:{click:s.addRole}},[s._v("\n    添加角色\n  ")]),s._v(" "),a("div",{staticClass:"sort-content"},[a("el-table",{staticStyle:{},attrs:{data:s.userData.list,border:"","header-cell-style":{"text-align":"center",color:"black"},"cell-style":{"text-align":"center"}}},[a("el-table-column",{attrs:{prop:"id",label:"序号"}}),s._v(" "),a("el-table-column",{attrs:{prop:"name",label:"角色账户名称"}}),s._v(" "),a("el-table-column",{attrs:{label:"状态",prop:"desStatus"}}),s._v(" "),a("el-table-column",{attrs:{prop:"created_at",label:"创建时间"}}),s._v(" "),a("el-table-column",{attrs:{width:"250px"},scopedSlots:s._u([{key:"default",fn:function(t){return[a("el-button",{attrs:{size:"mini"},on:{click:function(e){return s.modify(t.row.id)}}},[s._v("\n            修改\n          ")]),s._v(" "),a("el-switch",{staticStyle:{"margin-left":"30px"},attrs:{"active-text":"启用","inactive-text":"禁用"},model:{value:t.row.status,callback:function(e){s.$set(t.row,"status",e)},expression:"scope.row.status"}})]}}])},[a("template",{attrs:{"slot-scope":s.scope},slot:"header"},[s._v("\n          操作\n        ")])],2)],1)],1),s._v(" "),a("div",{staticClass:"pagination"},[a("el-pagination",{attrs:{layout:"prev,pager,next",background:"","page-size":s.limit,total:s.userData.total},on:{"current-change":s.changePage,"prev-click":s.prev,"next-click":s.next}})],1)],1)}a._withStripped=!0;var n=s("o0o1"),r=s.n(n),i=s("yXPU"),o=s.n(i),l={data:function(){return{scope:"scope",dialogVisible:!1,modifyStatus:!1,userData:[],limit:10,pages:1,defaultProps:{children:"_child",label:"name"},permisssionMenu:[],permissionList:[],form:{},roleId:""}},created:function(){this.getUserList()},mounted:function(){this.getPermissionMenu()},methods:{getUserList:function(){var s=this;return o()(r.a.mark(function e(){var t;return r.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,s.axios.get("/admin/getRoleList",{params:{limit:s.limit,pages:s.pages}});case 3:t=e.sent,s.userData=Object.assign(t.data,{list:t.data.list.map(function(e){return Object.assign(e,{status:1===e.status,desStatus:1===e.status?"启用":"禁用"})})}),e.next=10;break;case 7:e.prev=7,e.t0=e.catch(0);case 10:case"end":return e.stop()}},e,null,[[0,7]])}))()},addRole:function(){this.dialogVisible=!0},prev:function(){this.pages--,this.getUserList()},getPermissionMenu:function(){var s=this;return o()(r.a.mark(function e(){var t;return r.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,s.axios.get("/admin/menu",{params:{type:2}});case 3:t=e.sent,s.permisssionMenu=t.data,e.next=10;break;case 7:e.prev=7,e.t0=e.catch(0);case 10:case"end":return e.stop()}},e,null,[[0,7]])}))()},confirm:function(){var a=this;return o()(r.a.mark(function e(){var t,s;return r.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t=a.$refs.tree.getCheckedKeys().concat(a.$refs.tree.getHalfCheckedKeys()),e.prev=1,e.next=4,a.axios.post("/admin/addrole",{name:a.form.name,path:t.join(",")});case 4:s=e.sent,a.close(),a.$message.success({message:s.msg}),a.pages=1,a.getUserList(),e.next=14;break;case 11:e.prev=11,e.t0=e.catch(1);case 14:case"end":return e.stop()}},e,null,[[1,11]])}))()},modify:function(e){this.getRolePermission(e),this.roleId=e,this.modifyStatus=!0},getRolePermission:function(s){var a=this;return o()(r.a.mark(function e(){var t;return r.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,a.axios.get("/admin/getrole",{params:{role_id:s}});case 3:t=e.sent,a.$nextTick(function(){t.data.path.forEach(function(e){var t=a.$refs.tree.getNode(e);t.isLeaf?a.$refs.tree.setChecked(t,!0):(t.indeterminate=!0,t.checked=!0)})}),e.next=10;break;case 7:e.prev=7,e.t0=e.catch(0);case 10:case"end":return e.stop()}},e,null,[[0,7]])}))()},onChange:function(e){var t=this.$refs.tree.getNode(e);t.checked||this.findchildren(t.parent)},findchildren:function(e){var t=this.$refs.tree.getNode(e);t.isLeaf||(t.indeterminate=!0,t.checked=!0)},confirmModify:function(){var a=this;return o()(r.a.mark(function e(){var t,s;return r.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t=a.$refs.tree.getCheckedKeys().concat(a.$refs.tree.getHalfCheckedKeys()),e.prev=1,e.next=4,a.axios.post("/admin/uprole",{role_id:a.roleId,name:a.form.roleName,path:t.join(",")});case 4:s=e.sent,a.$message.success({message:s.msg}),a.form={},a.close(),a.getUserList(),e.next=14;break;case 11:e.prev=11,e.t0=e.catch(1);case 14:case"end":return e.stop()}},e,null,[[1,11]])}))()},close:function(){this.dialogVisible=!1,this.modifyStatus=!1,this.form={},this.$refs.tree.setCheckedKeys([])},changePage:function(e){this.pages=e,this.getUserList()},next:function(){this.pages++,this.getUserList()}},components:{}},c=(s("HuZL"),s("KHd+")),u=Object(c.a)(l,a,[],!1,null,"14505c45",null);u.options.__file="src/views/systemManage/roleList.vue";t.default=u.exports}}]);